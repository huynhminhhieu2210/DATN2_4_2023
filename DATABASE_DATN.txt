--CREATE DATABASE DB_QUANLYBANHANG
GO
USE DB_QUANLYBANHANG
GO
CREATE TABLE AREA(
	AREA_ID VARCHAR(20) NOT NULL,
	AREA_CODE VARCHAR(20) NULL,
	AREA_NAME NVARCHAR(500) NULL,
	 CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT AREA_PK PRIMARY KEY (AREA_ID)
)
GO
CREATE TABLE BRANCH(
	BRANCH_ID VARCHAR(20) NOT NULL,
	AREA_ID VARCHAR(20) NOT NULL,
	BRANCH_CODE VARCHAR(20) NULL,
	BRANCH_NAME NVARCHAR(500) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT BRANCH_PK PRIMARY KEY (BRANCH_ID)
)
GO
CREATE TABLE PRODUCT_TYPE(
	PRODUCT_TYPE_ID VARCHAR(20) NOT NULL,
	PRODUCT_TYPE_CODE VARCHAR(20) NULL,
	PRODUCT_TYPE_NAME NVARCHAR(500) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT PRODUCT_TYPE_PK PRIMARY KEY (PRODUCT_TYPE_ID)
)
GO
CREATE TABLE PRODUCTS(
	PRODUCT_ID VARCHAR(20) NOT NULL,
	PRODUCT_TYPE_ID VARCHAR(20) NOT NULL,
	SUPPLIER_ID VARCHAR(20) NOT NULL,
	PRODUCT_CODE VARCHAR(20) NULL,
	PRODUCT_NAME NVARCHAR(500) NULL,
	[DESCRIPTION] NVARCHAR(MAX) NULL,
	[NOTE] NVARCHAR(MAX) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT PRODUCTS_PK PRIMARY KEY (PRODUCT_ID)
)
GO
CREATE TABLE SUPPLIER(
	SUPPLIER_ID VARCHAR(20) NOT NULL,
	SUPPLIER_CODE VARCHAR(20) NULL,
	SUPPLIER_NAME NVARCHAR(500) NULL,
	SUPPLIER_PHONE VARCHAR(20) NULL,
	SUPPLIER_ADDRESS NVARCHAR(500) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT SUPPLIER_PK PRIMARY KEY (SUPPLIER_ID)
)
GO
CREATE TABLE COLOR(
	COLOR_ID VARCHAR(20) NOT NULL,
	COLOR_CODE VARCHAR(20) NULL,
	COLOR_NAME NVARCHAR(500) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT COLOR_PK PRIMARY KEY (COLOR_ID)
)
GO
CREATE TABLE PRODUCT_COLOR(
	PRODUCT_COLOR_ID VARCHAR(20) NOT NULL,
	COLOR_ID VARCHAR(20) NULL,
	PRODUCT_ID VARCHAR(20) NULL,
	WAREHOUSE_ID VARCHAR(20) NULL,
	STOCK INT NULL,
	PRICE DECIMAL(18,2) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT PRODUCT_COLOR_PK PRIMARY KEY (PRODUCT_COLOR_ID)
)
GO
CREATE TABLE WAREHOUSE(
	WAREHOUSE_ID VARCHAR(20) NOT NULL,
	BRANCH_ID VARCHAR(20) NOT NULL,
	AREA_ID VARCHAR(20) NOT NULL,
	WAREHOUSE_CODE VARCHAR(20) NULL,
	WAREHOUSE_NAME NVARCHAR(500) NULL,
	WAREHOUSE_ADDRESS NVARCHAR(500) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT WAREHOUSE_PK PRIMARY KEY (WAREHOUSE_ID)
)
GO
CREATE TABLE DOC_IMP_PRODUCT(
	DOC_IMP_PRODUCT_ID VARCHAR(20) NOT NULL,
	DOC_IMP_PRODUCT_CODE VARCHAR(20) NOT NULL,
	BRANCH_ID VARCHAR(20) NOT NULL,
	DELIVER NVARCHAR(500) NULL,
	RECEIVER VARCHAR(20) NULL,
	TOTAL DECIMAL(18,2) NULL,
	[STATUS] VARCHAR(10) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT DOC_IMP_PRODUCT_PK PRIMARY KEY (DOC_IMP_PRODUCT_ID)
)
GO
CREATE TABLE DOC_IMP_PRODUCT_DT(
	DOC_IMP_PRODUCT_DT_ID VARCHAR(20) NOT NULL,
	PRODUCT_ID VARCHAR(20) NOT NULL,
	PRICE DECIMAL(18,2) NOT NULL,
	[STATUS] VARCHAR(10) NULL,
	DOC_IMP_PRODUCT_ID VARCHAR(20) NULL
	CONSTRAINT DOC_IMP_PRODUCT_DT_PK PRIMARY KEY (DOC_IMP_PRODUCT_DT_ID)
)
GO
CREATE TABLE INVOICE(
	INVOICE_ID VARCHAR(20) NOT NULL,
	INVOICE_CODE VARCHAR(20) NOT NULL,
	CUSTOMER_ID VARCHAR(20) NOT NULL,
	RECEIVER NVARCHAR(500) NULL,
	RECEIVER_ADDRESS NVARCHAR(500) NULL,
	RECEIVER_PHONE VARCHAR(20) NOT NULL,
	TOTAL DECIMAL(18,2) NULL,
	[STATUS] VARCHAR(10) NULL,
	MONEY_PAYED DECIMAL(18,2) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT INVOICE_PK PRIMARY KEY (INVOICE_ID)
)
GO
CREATE TABLE INVOICE_DT(
	INVOICE_DT_ID VARCHAR(20) NOT NULL,
	INVOICE_ID VARCHAR(20) NOT NULL,
	PRODUCT_COLOR_ID VARCHAR(20) NOT NULL,
	QUANTITY INT NULL,
	PRICE DECIMAL(18,2) NOT NULL
	CONSTRAINT INVOICE_DT_PK PRIMARY KEY (INVOICE_DT_ID)
)
GO
CREATE TABLE CUSTOMER(
	CUSTOMER_ID VARCHAR(20) NOT NULL,
	CUSTOMER_CODE VARCHAR(20) NOT NULL,
	CUSTOMER_NAME NVARCHAR(500) NOT NULL,
	CUSTOMER_FULLNAME NVARCHAR(500) NULL,
	EMAIL VARCHAR(100) NULL,
	PHONE VARCHAR(20) NOT NULL,
	[ADDRESS] NVARCHAR(500) NULL,
	[STATUS] VARCHAR(10) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT CUSTOMER_PK PRIMARY KEY (CUSTOMER_ID)
)
GO
CREATE TABLE [USER](
	[USER_ID] VARCHAR(20) NOT NULL,
	BRANCH_ID VARCHAR(20) NOT NULL,
	ROLE_USER_ID VARCHAR(20) NOT NULL,
	USER_CODE VARCHAR(20) NOT NULL,
	[USER_NAME] NVARCHAR(500) NOT NULL,
	USER_FULLNAME NVARCHAR(500) NULL,
	EMAIL VARCHAR(100) NULL,
	PHONE VARCHAR(20) NOT NULL,
	[ADDRESS] NVARCHAR(500) NULL,
	[STATUS] VARCHAR(10) NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT USER_PK PRIMARY KEY ([USER_ID])
)
GO
CREATE TABLE ROLE_USER(
	ROLE_USER_ID VARCHAR(20) NOT NULL,
	ROLE_USER_CODE VARCHAR(20) NOT NULL,
	ROLE_USER_NAME NVARCHAR(500) NOT NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT ROLE_USER_PK PRIMARY KEY (ROLE_USER_ID)
)
GO
CREATE TABLE [LOG](
	LOG_ID VARCHAR(20) NOT NULL,
	REF_ID VARCHAR(20) NOT NULL,
	LOG_DATE DATETIME NOT NULL,
	LOG_STEP VARCHAR(20) NOT NULL,
	LOG_DESC NVARCHAR(MAX) NOT NULL,
	  CREATE_ID VARCHAR(20) NOT NULL,
	CREATE_DATE DATETIME NULL
	CONSTRAINT LOG_PK PRIMARY KEY (LOG_ID)
)
GO
ALTER TABLE AREA ADD CONSTRAINT fk_area_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE BRANCH ADD CONSTRAINT fk_branch_area_id_area FOREIGN KEY (AREA_ID) REFERENCES AREA (AREA_ID);
ALTER TABLE BRANCH ADD CONSTRAINT fk_branch_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE PRODUCT_TYPE ADD CONSTRAINT fk_product_type_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE PRODUCTS ADD CONSTRAINT fk_products_product_type_id_product_type FOREIGN KEY (PRODUCT_TYPE_ID) REFERENCES PRODUCT_TYPE (PRODUCT_TYPE_ID);
ALTER TABLE PRODUCTS ADD CONSTRAINT fk_products_supplier_id_supplier FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER (SUPPLIER_ID);
ALTER TABLE PRODUCTS ADD CONSTRAINT fk_products_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE SUPPLIER ADD CONSTRAINT fk_supplier_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE COLOR ADD CONSTRAINT fk_color_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE PRODUCT_COLOR ADD CONSTRAINT fk_product_color_color_id_color FOREIGN KEY (COLOR_ID) REFERENCES COLOR (COLOR_ID);
ALTER TABLE PRODUCT_COLOR ADD CONSTRAINT fk_product_color_product_id_products FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS (PRODUCT_ID);
ALTER TABLE PRODUCT_COLOR ADD CONSTRAINT fk_product_color_warehouse_id_warehouse FOREIGN KEY (WAREHOUSE_ID) REFERENCES WAREHOUSE (WAREHOUSE_ID);
ALTER TABLE PRODUCT_COLOR ADD CONSTRAINT fk_product_color_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE WAREHOUSE ADD CONSTRAINT fk_warehouse_branch_id_branch FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH (BRANCH_ID);
ALTER TABLE WAREHOUSE ADD CONSTRAINT fk_warehouse_area_id_area FOREIGN KEY (AREA_ID) REFERENCES AREA (AREA_ID);
ALTER TABLE WAREHOUSE ADD CONSTRAINT fk_warehouse_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);


ALTER TABLE DOC_IMP_PRODUCT ADD CONSTRAINT fk_doc_imp_product_branch_id_branch FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH (BRANCH_ID);
ALTER TABLE DOC_IMP_PRODUCT ADD CONSTRAINT fk_doc_imp_product_receiver_user FOREIGN KEY (RECEIVER) REFERENCES [USER] ([USER_ID]);
ALTER TABLE DOC_IMP_PRODUCT ADD CONSTRAINT fk_doc_imp_product_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE DOC_IMP_PRODUCT_DT ADD CONSTRAINT fk_doc_imp_product_dt_doc_imp_product_id_doc_imp_product FOREIGN KEY (DOC_IMP_PRODUCT_ID) REFERENCES DOC_IMP_PRODUCT (DOC_IMP_PRODUCT_ID);
ALTER TABLE DOC_IMP_PRODUCT_DT ADD CONSTRAINT fk_doc_imp_product_dt_product_id_products FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS (PRODUCT_ID);

ALTER TABLE INVOICE ADD CONSTRAINT fk_invoice_customer_id_customer FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID);
ALTER TABLE INVOICE ADD CONSTRAINT fk_invoice_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

ALTER TABLE INVOICE_DT ADD CONSTRAINT fk_invoice_dt_invoice_id_invoice FOREIGN KEY (INVOICE_ID) REFERENCES INVOICE (INVOICE_ID);
ALTER TABLE INVOICE_DT ADD CONSTRAINT fk_invoice_dt_product_color_id_product_color FOREIGN KEY (PRODUCT_COLOR_ID) REFERENCES PRODUCT_COLOR (PRODUCT_COLOR_ID);

ALTER TABLE [USER] ADD CONSTRAINT fk_user_role_user_id_role_user FOREIGN KEY (ROLE_USER_ID) REFERENCES ROLE_USER (ROLE_USER_ID);
ALTER TABLE [USER] ADD CONSTRAINT fk_user_branch_id_branch FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH (BRANCH_ID);
--ALTER TABLE [USER] ADD CONSTRAINT fk_user_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

--ALTER TABLE ROLE_USER ADD CONSTRAINT fk_role_user_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);

--ALTER TABLE [LOG] ADD CONSTRAINT fk_log_create_id_user FOREIGN KEY (CREATE_ID) REFERENCES [USER] ([USER_ID]);
GO
